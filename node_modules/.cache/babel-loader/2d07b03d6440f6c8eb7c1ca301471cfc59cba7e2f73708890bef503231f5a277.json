{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getDoc, doc, addDoc, collection, query, where, getDocs } from 'firebase/firestore';\nimport { db } from '../firebase/firebase';\nimport { invertiData } from '@/utils/dateUtils';\nexport default {\n  name: \"EventoView\",\n  props: ['eventoId'],\n  data() {\n    return {\n      evento: null,\n      nome: \"\",\n      cognome: \"\",\n      data_di_nascita: \"\",\n      presenzaConfermata: false,\n      imgCopertinaURL: \"\",\n      daysLeftToBook: \"\"\n    };\n  },\n  async mounted() {\n    try {\n      const docRef = doc(db, 'eventi', this.eventoId);\n      const docSnap = await getDoc(docRef);\n      if (docSnap.exists()) {\n        this.evento = docSnap.data();\n        this.imgCopertinaURL = this.evento.imgCopertina;\n        const dif = new Date(this.evento.data) - new Date();\n        this.daysLeftToBook = Math.ceil(dif / (1000 * 60 * 60 * 24));\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  },\n  methods: {\n    invertiData,\n    async aggiungiPartecipante() {\n      try {\n        const partecipanteRef = collection(db, \"eventi\", this.eventoId, \"partecipanti\");\n        let partecipanteId;\n        console.log(\"ci sono\");\n        const docRef = await addDoc(partecipanteRef, {\n          nome: this.nome,\n          cognome: this.cognome,\n          data_di_nascita: this.data_di_nascita,\n          presenzaConfermata: this.presenzaConfermata\n        });\n        partecipanteId = docRef.id;\n        this.nome = \"\";\n        this.cognome = \"\";\n        this.data_di_nascita = \"\";\n        this.$router.push({\n          name: \"PartecipanteView\",\n          params: {\n            eventoId: this.eventoId,\n            partecipanteId: partecipanteId\n          }\n        });\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    async recuperaBiglietto() {\n      const partecipantiRef = collection(db, \"eventi\", this.eventoId, \"partecipanti\");\n      const q = query(partecipantiRef, where(\"nome\", \"==\", this.nome), where(\"cognome\", \"==\", this.cognome), where(\"data_di_nascita\", \"==\", this.data_di_nascita));\n      const snapshot = await getDocs(q);\n      if (!snapshot.empty) {\n        this.partecipanteId = snapshot.id;\n        this.$router.push({\n          name: \"PartecipanteView\",\n          params: {\n            eventoId: this.eventoId,\n            partecipanteId: snapshot.docs[0].id\n          }\n        });\n      }\n    }\n  }\n};","map":{"version":3,"names":["getDoc","doc","addDoc","collection","query","where","getDocs","db","invertiData","name","props","data","evento","nome","cognome","data_di_nascita","presenzaConfermata","imgCopertinaURL","daysLeftToBook","mounted","docRef","eventoId","docSnap","exists","imgCopertina","dif","Date","Math","ceil","error","console","log","methods","aggiungiPartecipante","partecipanteRef","partecipanteId","id","$router","push","params","recuperaBiglietto","partecipantiRef","q","snapshot","empty","docs"],"sources":["/Users/vladpostu/Desktop/easyticket/views/EventoView.vue"],"sourcesContent":["\n\n<script>\nimport { getDoc, doc, addDoc, collection, query, where, getDocs } from 'firebase/firestore'\nimport { db } from '../firebase/firebase'\nimport { invertiData } from '@/utils/dateUtils';\n\nexport default {\n    name: \"EventoView\",\n    props: ['eventoId'],\n    data() {\n        return {\n            evento: null,\n            nome: \"\",\n            cognome: \"\",\n            data_di_nascita: \"\",\n            presenzaConfermata: false,\n            imgCopertinaURL: \"\",\n            daysLeftToBook: \"\",\n        }\n    },\n    async mounted() {\n        try {\n            const docRef = doc(db, 'eventi', this.eventoId)\n            const docSnap = await getDoc(docRef)\n\n            if (docSnap.exists()) {\n                this.evento = docSnap.data()\n                this.imgCopertinaURL = this.evento.imgCopertina;\n                const dif = new Date(this.evento.data) - (new Date)\n                this.daysLeftToBook = Math.ceil(dif / (1000 * 60 * 60 * 24))\n            }\n        } catch (error) {\n            console.log(error)\n        }\n\n    },\n    methods: {\n        invertiData,\n        async aggiungiPartecipante() {\n            try {\n              const partecipanteRef = collection(db, \"eventi\", this.eventoId, \"partecipanti\")\n            let partecipanteId;\n\n            console.log(\"ci sono\")\n\n            const docRef = await addDoc(partecipanteRef, {\n                nome: this.nome,\n                cognome: this.cognome,\n                data_di_nascita: this.data_di_nascita,\n                presenzaConfermata: this.presenzaConfermata,\n            });\n\n            partecipanteId = docRef.id;\n\n            this.nome = \"\";\n            this.cognome = \"\";\n            this.data_di_nascita = \"\";\n\n            this.$router.push({\n                name: \"PartecipanteView\",\n                params: {\n                    eventoId: this.eventoId,\n                    partecipanteId: partecipanteId,\n                }\n            })\n            } catch(error) {\n              console.log(error);\n            }\n        },\n        async recuperaBiglietto() {\n\n            const partecipantiRef = collection(db, \"eventi\", this.eventoId, \"partecipanti\");\n\n            const q = query(\n                partecipantiRef,\n                where(\"nome\", \"==\", this.nome),\n                where(\"cognome\", \"==\", this.cognome),\n                where(\"data_di_nascita\", \"==\", this.data_di_nascita)\n            );\n\n            const snapshot = await getDocs(q);\n\n            if (!snapshot.empty) {\n                this.partecipanteId = snapshot.id;\n                this.$router.push({\n                    name: \"PartecipanteView\",\n                    params: {\n                        eventoId: this.eventoId,\n                        partecipanteId: snapshot.docs[0].id,\n                    }\n\n                })\n            }\n        }\n    }\n}\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}